<!DOCTYPE html>
<html lang="en" class="govuk-template">
  <head>
    <meta charset="utf-8">
    <title>Pre-application report - BOPS Experiments</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0b0c0c">

    <link rel="icon" sizes="48x48" href="/assets/images/favicon.ico">
    <link rel="icon" sizes="any" href="/assets/images/favicon.svg" type="image/svg+xml">
    <link rel="mask-icon" href="/assets/images/govuk-icon-mask.svg" color="#0b0c0c">
    <link rel="apple-touch-icon" href="/assets/images/govuk-icon-180.png">

    <link rel="stylesheet" href="/stylesheets/govuk-frontend.min.css">
    <style>
      .app-contents-list li {
        padding-bottom: 7.5px;
      }
      .app-details-list p {
        margin-bottom: 5px;
      }
      .app-placeholder-box {
        background-color: #f3f2f1;
        height: 300px;
        margin-top: 15px;
      }

      /* Review controls */
      .app-review-controls {
        margin-top: 20px;
      }

      .app-section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 15px;
        flex-wrap: wrap;
      }

      .app-section-header .govuk-heading-l {
        margin-bottom: 0;
      }

      .app-review-tag {
        flex: 0 0 auto;
        white-space: nowrap;
        width: auto !important;
        max-width: none;
      }

      .app-review-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0;
      }

      .app-review-button {
        font-family: "GDS Transport", arial, sans-serif;
        font-size: 16px;
        font-weight: 400;
        line-height: 1.25;
        padding: 8px 15px;
        border: 2px solid #0b0c0c;
        background-color: #ffffff;
        color: #0b0c0c;
        cursor: pointer;
        margin: 0;
        position: relative;
      }

      .app-review-button:first-child {
        border-radius: 4px 0 0 4px;
      }

      .app-review-button:last-child {
        border-radius: 0 4px 4px 0;
      }

      .app-review-button:not(:first-child) {
        margin-left: -2px;
      }

      .app-review-button:hover {
        background-color: #f3f2f1;
      }

      .app-review-button:focus {
        outline: 3px solid #ffdd00;
        outline-offset: 0;
        z-index: 1;
      }

      .app-review-button[aria-pressed="true"] {
        background-color: #0b0c0c;
        color: #ffffff;
        z-index: 1;
      }

      .app-review-button[aria-pressed="true"]:hover {
        background-color: #383f43;
      }

      .app-review-comments {
        margin-top: 15px;
      }

      .app-review-comments[hidden] {
        display: none;
      }

      .app-review-comments .govuk-textarea {
        margin-bottom: 10px;
      }

      .app-review-comments__actions {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .app-review-comments__saved-state {
        display: none;
        margin-bottom: 0;
      }

      .app-review-comments__saved-state.visible {
        display: block;
      }

      .app-review-comments--saved .govuk-textarea {
        background-color: #f3f2f1;
        color: #505a5f;
      }

      .app-review-comments--saved .app-review-comments__actions .app-save-comment {
        display: none;
      }
    </style>
  </head>
  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <a href="#main-content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

    <header class="govuk-header" data-module="govuk-header">
      <div class="govuk-header__container govuk-width-container">
        <div class="govuk-header__logo">
          <a href="/" class="govuk-header__link govuk-header__link--homepage">
            <span class="govuk-header__logotype">
              <span class="govuk-header__logotype-text">
                GOV.UK
              </span>
            </span>
          </a>
        </div>
        <div class="govuk-header__content">
          <a href="/" class="govuk-header__link govuk-header__service-name">
            BOPS Experiments
          </a>
        </div>
      </div>
    </header>

    <div class="govuk-width-container">
      <a href="/" class="govuk-back-link">Back</a>
      <main class="govuk-main-wrapper" id="main-content" role="main">
        <div class="govuk-notification-banner govuk-notification-banner--info" role="region" aria-labelledby="experiment-info-title" data-module="govuk-notification-banner">
          <div class="govuk-notification-banner__header">
            <h2 class="govuk-notification-banner__title" id="experiment-info-title">
              Experiment brief
            </h2>
          </div>
          <div class="govuk-notification-banner__content">
            <p class="govuk-body">This is a prototype of the <strong>pre-application report preview</strong> that a manager in the UK planning back office system (BOPS) will review before it is sent to the applicant.</p>
            <p class="govuk-body govuk-!-margin-bottom-0">The report provides guidance on a planning proposal, helping applicants understand what to expect when submitting their formal application.</p>
          </div>
        </div>

        <h1 class="govuk-heading-xl">Pre-application report</h1>

        <p class="govuk-body-l">
          This report gives clear guidance on your proposal, helping you understand what to expect when submitting your formal planning application.
        </p>

        <div class="app-details-list govuk-!-margin-bottom-6">
          <p class="govuk-body-s"><strong>2 Desendans Road, Green Village, BU2 3RH</strong></p>
          <p class="govuk-body-s">Pre-application number: <strong>23-00527-PRE</strong></p>
          <p class="govuk-body-s">Case officer: <strong>John Smith</strong></p>
          <p class="govuk-body-s">Date of report: <strong>[DD/MM/YYYY]</strong></p>
        </div>

        <p class="govuk-body-s govuk-!-margin-bottom-1">Contents</p>
        <ul class="govuk-list govuk-body-s govuk-!-margin-bottom-6 app-contents-list">
          <li>— <a href="#pre-application-outcome" class="govuk-link">Pre-application outcome</a></li>
          <li>— <a href="#officer-contact-details" class="govuk-link">Officer contact details</a></li>
          <li>— <a href="#your-pre-application-details" class="govuk-link">Your pre-application details</a></li>
          <li>— <a href="#site-map" class="govuk-link">Site map</a></li>
          <li>— <a href="#site-constraints" class="govuk-link">Site constraints</a></li>
          <li>— <a href="#site-history" class="govuk-link">Site history</a></li>
          <li>— <a href="#site-and-surroundings" class="govuk-link">Site and surroundings</a></li>
          <li>— <a href="#planning-considerations-and-advice" class="govuk-link">Planning considerations and advice</a></li>
          <li>— <a href="#summary-of-advice" class="govuk-link">Summary of advice</a></li>
          <li>— <a href="#requirements" class="govuk-link">Requirements</a></li>
          <li>— <a href="#relevant-policies-and-guidance" class="govuk-link">Relevant policies and guidance</a></li>
          <li>— <a href="#next-steps" class="govuk-link">Next Steps</a></li>
          <li>— <a href="#disclaimer" class="govuk-link">Disclaimer</a></li>
        </ul>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="pre-application-outcome">Pre-application outcome</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="pre-application-outcome">
          <div class="app-review-buttons" role="group" aria-label="Review options for Pre-application outcome">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-pre-application-outcome">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-pre-application-outcome" name="comments-pre-application-outcome" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="officer-contact-details">Officer contact details</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="officer-contact-details">
          <div class="app-review-buttons" role="group" aria-label="Review options for Officer contact details">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-officer-contact-details">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-officer-contact-details" name="comments-officer-contact-details" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="your-pre-application-details">Your pre-application details</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="your-pre-application-details">
          <div class="app-review-buttons" role="group" aria-label="Review options for Your pre-application details">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-your-pre-application-details">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-your-pre-application-details" name="comments-your-pre-application-details" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="site-map">Site map</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="site-map">
          <div class="app-review-buttons" role="group" aria-label="Review options for Site map">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-site-map">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-site-map" name="comments-site-map" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="site-constraints">Site constraints</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="site-constraints">
          <div class="app-review-buttons" role="group" aria-label="Review options for Site constraints">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-site-constraints">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-site-constraints" name="comments-site-constraints" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="site-history">Site history</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="site-history">
          <div class="app-review-buttons" role="group" aria-label="Review options for Site history">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-site-history">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-site-history" name="comments-site-history" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="site-and-surroundings">Site and surroundings</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="site-and-surroundings">
          <div class="app-review-buttons" role="group" aria-label="Review options for Site and surroundings">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-site-and-surroundings">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-site-and-surroundings" name="comments-site-and-surroundings" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="planning-considerations-and-advice">Planning considerations and advice</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="planning-considerations-and-advice">
          <div class="app-review-buttons" role="group" aria-label="Review options for Planning considerations and advice">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-planning-considerations-and-advice">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-planning-considerations-and-advice" name="comments-planning-considerations-and-advice" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="summary-of-advice">Summary of advice</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="summary-of-advice">
          <div class="app-review-buttons" role="group" aria-label="Review options for Summary of advice">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-summary-of-advice">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-summary-of-advice" name="comments-summary-of-advice" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="requirements">Requirements</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="requirements">
          <div class="app-review-buttons" role="group" aria-label="Review options for Requirements">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-requirements">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-requirements" name="comments-requirements" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="relevant-policies-and-guidance">Relevant policies and guidance</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="relevant-policies-and-guidance">
          <div class="app-review-buttons" role="group" aria-label="Review options for Relevant policies and guidance">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-relevant-policies-and-guidance">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-relevant-policies-and-guidance" name="comments-relevant-policies-and-guidance" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="next-steps">Next Steps</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="next-steps">
          <div class="app-review-buttons" role="group" aria-label="Review options for Next Steps">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-next-steps">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-next-steps" name="comments-next-steps" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
        <div class="app-section-header govuk-!-margin-top-6">
          <h2 class="govuk-heading-l" id="disclaimer">Disclaimer</h2>
          <strong class="govuk-tag govuk-tag--grey app-review-tag">Not reviewed</strong>
        </div>
        <div class="app-placeholder-box"></div>
        <div class="app-review-controls" data-section="disclaimer">
          <div class="app-review-buttons" role="group" aria-label="Review options for Disclaimer">
            <button type="button" class="app-review-button" data-action="return" aria-pressed="false">Return with comments</button>
            <button type="button" class="app-review-button" data-action="edit" aria-pressed="false">Edit</button>
          </div>
          <div class="app-review-comments" hidden>
            <label class="govuk-label" for="comments-disclaimer">Comments for officer</label>
            <textarea class="govuk-textarea" id="comments-disclaimer" name="comments-disclaimer" rows="3"></textarea>
            <div class="app-review-comments__actions">
              <button type="button" class="govuk-button govuk-button--secondary app-save-comment" data-module="govuk-button">Save comment</button>
              <p class="govuk-body app-review-comments__saved-state">
                Comment saved. <a href="#" class="govuk-link app-undo-comment">Undo</a>
              </p>
            </div>
          </div>
        </div>

        <div class="govuk-!-margin-top-6">
          <button type="submit" class="govuk-button" data-module="govuk-button" id="submit-review">
            Submit review
          </button>
        </div>

      </main>
    </div>

    <footer class="govuk-footer">
      <div class="govuk-width-container">
        <div class="govuk-footer__meta">
          <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
            <span class="govuk-footer__licence-description">
              Built using the
              <a class="govuk-footer__link" href="https://design-system.service.gov.uk/" rel="noopener noreferrer" target="_blank">
                GOV.UK Design System
              </a>
            </span>
          </div>
        </div>
      </div>
    </footer>

    <script type="module" src="/javascripts/govuk-frontend.min.js"></script>
    <script type="module">
      import { initAll } from '/javascripts/govuk-frontend.min.js'
      initAll()
    </script>

    <script>
      (function() {
        const reviewControls = document.querySelectorAll('.app-review-controls');

        function getStatusTag(control) {
          // The tag is now in the section header, which is the previous sibling of the placeholder box
          const section = control.dataset.section;
          return document.querySelector('.app-section-header #' + section).parentElement.querySelector('.app-review-tag');
        }

        function updateStatus(control, action) {
          const statusEl = getStatusTag(control);

          if (action === 'return') {
            control.dataset.status = 'returned';
            statusEl.className = 'govuk-tag govuk-tag--yellow app-review-tag';
            statusEl.textContent = 'Returned for comments';
          } else if (action === 'edit') {
            // Edit doesn't change the status, just alerts for now
          }
        }

        reviewControls.forEach(function(control) {
          const buttons = control.querySelectorAll('.app-review-button');
          const commentsSection = control.querySelector('.app-review-comments');

          buttons.forEach(function(button) {
            button.addEventListener('click', function() {
              const action = this.dataset.action;

              // Handle edit action separately
              if (action === 'edit') {
                const section = control.dataset.section;
                alert('This would open the edit interface for: ' + section);
                return;
              }

              // Reset all buttons in this group
              buttons.forEach(function(btn) {
                if (btn.dataset.action !== 'edit') {
                  btn.setAttribute('aria-pressed', 'false');
                }
              });

              // Toggle current button
              const wasPressed = this.getAttribute('aria-pressed') === 'true';
              if (!wasPressed) {
                this.setAttribute('aria-pressed', 'true');
              }

              // Show/hide comments
              if (action === 'return' && !wasPressed) {
                commentsSection.removeAttribute('hidden');
              } else {
                commentsSection.setAttribute('hidden', '');
              }

              // If unpressing return button, reset to not reviewed
              if (wasPressed) {
                control.removeAttribute('data-status');
                const statusEl = getStatusTag(control);
                statusEl.className = 'govuk-tag govuk-tag--grey app-review-tag';
                statusEl.textContent = 'Not reviewed';
              }
            });
          });
        });

        // Save comment buttons
        document.querySelectorAll('.app-save-comment').forEach(function(button) {
          button.addEventListener('click', function() {
            const control = this.closest('.app-review-controls');
            const commentsSection = control.querySelector('.app-review-comments');
            const textarea = commentsSection.querySelector('.govuk-textarea');
            const savedState = this.parentElement.querySelector('.app-review-comments__saved-state');

            // Update status to "Returned for comments"
            updateStatus(control, 'return');

            // Disable textarea and show saved state
            textarea.setAttribute('readonly', '');
            commentsSection.classList.add('app-review-comments--saved');
            savedState.classList.add('visible');
          });
        });

        // Undo comment buttons
        document.querySelectorAll('.app-undo-comment').forEach(function(link) {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const control = this.closest('.app-review-controls');
            const commentsSection = control.querySelector('.app-review-comments');
            const textarea = commentsSection.querySelector('.govuk-textarea');
            const savedState = this.closest('.app-review-comments__saved-state');

            // Re-enable textarea and hide saved state
            textarea.removeAttribute('readonly');
            commentsSection.classList.remove('app-review-comments--saved');
            savedState.classList.remove('visible');

            // Reset status to not reviewed
            control.removeAttribute('data-status');
            const statusEl = getStatusTag(control);
            statusEl.className = 'govuk-tag govuk-tag--grey app-review-tag';
            statusEl.textContent = 'Not reviewed';
          });
        });

        // Submit review button
        document.getElementById('submit-review').addEventListener('click', function() {
          alert('Review submitted successfully!');
        });
      })();
    </script>
  </body>
</html>
